<?xml version="1.0" encoding="UTF-8"?>
<data>
  <item>
    <id>1</id>
    <timestamp>2024-01-15T10:30:00Z</timestamp>
    <metadata></metadata>
    <topic>—Ç–µ–º–∞1</topic>
    <source>–∏—Å—Ç–æ—á–Ω–∏–∫1</source>
    <dialogue>
      <message>
        <role>—Ä–æ–ª—å1</role>
        <text><![CDATA[—Ç–µ–∫—Å—Ç1 —Å—Ç—Ä–æ–∫–∞1
—Ç–µ–∫—Å—Ç1 —Å—Ç—Ä–æ–∫–∞2
—Ç–µ–∫—Å—Ç1 —Å—Ç—Ä–æ–∫–∞3]]></text>
      </message>
      <message>
        <role>—Ä–æ–ª—å2</role>
        <text><![CDATA[—Ç–µ–∫—Å—Ç2 —Å—Ç—Ä–æ–∫–∞1
—Ç–µ–∫—Å—Ç2 —Å—Ç—Ä–æ–∫–∞2
—Ç–µ–∫—Å—Ç2 —Å—Ç—Ä–æ–∫–∞3]]></text>
      </message>
    </dialogue>
  </item>
  <item>
    <id>2</id>
    <timestamp>2024-01-15T11:00:00Z</timestamp>
    <metadata></metadata>
    <topic>—Ç–µ–º–∞2</topic>
    <source>–∏—Å—Ç–æ—á–Ω–∏–∫2</source>
    <dialogue>
      <message>
        <role>—Ä–æ–ª—å1</role>
        <text><![CDATA[—Ç–µ–∫—Å—Ç3 —Å—Ç—Ä–æ–∫–∞1
—Ç–µ–∫—Å—Ç3 —Å—Ç—Ä–æ–∫–∞2]]></text>
      </message>
      <message>
        <role>—Ä–æ–ª—å2</role>
        <text><![CDATA[—Ç–µ–∫—Å—Ç4 —Å—Ç—Ä–æ–∫–∞1
—Ç–µ–∫—Å—Ç4 —Å—Ç—Ä–æ–∫–∞2
—Ç–µ–∫—Å—Ç4 —Å—Ç—Ä–æ–∫–∞3
—Ç–µ–∫—Å—Ç4 —Å—Ç—Ä–æ–∫–∞4]]></text>
      </message>
    </dialogue>
  </item>
</data>



[
  {
    "id": 1,
    "timestamp": "2024-01-15T10:30:00Z",
    "metadata": {},
    "topic": "—Ç–µ–º–∞1",
    "source": "–∏—Å—Ç–æ—á–Ω–∏–∫1", 
    "dialogue": [
      {
        "role": "—Ä–æ–ª—å1",
        "text": "—Ç–µ–∫—Å—Ç1 —Å—Ç—Ä–æ–∫–∞1\n—Ç–µ–∫—Å—Ç1 —Å—Ç—Ä–æ–∫–∞2\n—Ç–µ–∫—Å—Ç1 —Å—Ç—Ä–æ–∫–∞3"
      },
      {
        "role": "—Ä–æ–ª—å2",
        "text": "—Ç–µ–∫—Å—Ç2 —Å—Ç—Ä–æ–∫–∞1\n—Ç–µ–∫—Å—Ç2 —Å—Ç—Ä–æ–∫–∞2\n—Ç–µ–∫—Å—Ç2 —Å—Ç—Ä–æ–∫–∞3"
      }
    ]
  },
  {
    "id": 2,
    "timestamp": "2024-01-15T11:00:00Z",
    "metadata": {},
    "topic": "—Ç–µ–º–∞2",
    "source": "–∏—Å—Ç–æ—á–Ω–∏–∫2",
    "dialogue": [
      {
        "role": "—Ä–æ–ª—å1", 
        "text": "—Ç–µ–∫—Å—Ç3 —Å—Ç—Ä–æ–∫–∞1\n—Ç–µ–∫—Å—Ç3 —Å—Ç—Ä–æ–∫–∞2"
      },
      {
        "role": "—Ä–æ–ª—å2",
        "text": "—Å—Ç—Ä–æ–∫–∞1\n—Å—Ç—Ä–æ–∫–∞2\n—Å—Ç—Ä–æ–∫–∞3"
      }
    ]
  }
]


[
  {
    "id": 1,
    "timestamp": "2024-01-15T10:30:00Z",
    "metadata": {},
    "topic": "—Ç–µ–º–∞1",
    "source": "–∏—Å—Ç–æ—á–Ω–∏–∫1",
    "dialogue": [
      {
        "role": "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
        "lines": [
          "–≠—Ç–æ –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
          "–≠—Ç–æ –≤—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è", 
          "–≠—Ç–æ —Ç—Ä–µ—Ç—å—è —Å—Ç—Ä–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
        ]
      },
      {
        "role": "–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç",
        "lines": [
          "–≠—Ç–æ –æ—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ —Å—Ç—Ä–æ–∫–∞ 1",
          "–≠—Ç–æ –æ—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ —Å—Ç—Ä–æ–∫–∞ 2",
          "–≠—Ç–æ –æ—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ —Å—Ç—Ä–æ–∫–∞ 3"
        ]
      },
      {
        "role": "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å", 
        "lines": [
          "–≠—Ç–æ –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
        ]
      }
    ]
  },
  {
    "id": 2,
    "timestamp": "2024-01-15T11:00:00Z",
    "metadata": {},
    "topic": "—Ç–µ–º–∞2",
    "source": "–∏—Å—Ç–æ—á–Ω–∏–∫2",
    "dialogue": [
      {
        "role": "–º–æ–¥–µ—Ä–∞—Ç–æ—Ä",
        "lines": [
          "–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞",
          "–í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞"
        ]
      },
      {
        "role": "–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç",
        "lines": [
          "–û—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—É",
          "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞",
          "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞"
        ]
      }
    ]
  }
]


import json
import xml.etree.ElementTree as ET
from pathlib import Path

def check_json_simple(file_path):
    """–ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ JSON —Ñ–∞–π–ª–∞"""
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            content = f.read()
            data = json.loads(content)
        print("‚úì JSON —Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω")
        return True
    except json.JSONDecodeError as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –≤ JSON:")
        print(f"   –°—Ç—Ä–æ–∫–∞ {e.lineno}: {e.msg}")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–±–ª–µ–º–Ω—É—é —Å—Ç—Ä–æ–∫—É
        lines = content.split('\n')
        if e.lineno <= len(lines):
            error_line = lines[e.lineno - 1]
            print(f"   –ö–æ–Ω—Ç–µ–∫—Å—Ç: ...{error_line[max(0, e.colno-20):e.colno+20]}...")
        return False
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        return False

def check_xml_simple(file_path):
    """–ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ XML —Ñ–∞–π–ª–∞"""
    try:
        tree = ET.parse(file_path)
        print("‚úì XML —Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω")
        return True
    except ET.ParseError as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –≤ XML:")
        print(f"   –°—Ç—Ä–æ–∫–∞ {e.position[0]}: {e.msg}")
        return False
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        return False

def read_json_simple(file_path):
    """–ü—Ä–æ—Å—Ç–æ–µ —á—Ç–µ–Ω–∏–µ JSON —Ñ–∞–π–ª–∞"""
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            data = json.load(f)
        
        print("üìñ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ JSON:")
        for i, item in enumerate(data):
            print(f"  –û–±—ä–µ–∫—Ç {i+1}:")
            print(f"    ID: {item.get('id', 'N/A')}")
            print(f"    Topic: {item.get('topic', 'N/A')}")
            
            dialogue = item.get('dialogue', [])
            if dialogue and isinstance(dialogue, list):
                if isinstance(dialogue[0], str):
                    # –§–æ—Ä–º–∞—Ç: –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫
                    print(f"    Dialogue ({len(dialogue)} —Å–æ–æ–±—â–µ–Ω–∏–π):")
                    for j, text in enumerate(dialogue):
                        preview = text.replace('\n', '\\n')[:50]
                        print(f"      [{j}]: {preview}{'...' if len(text) > 50 else ''}")
                else:
                    # –§–æ—Ä–º–∞—Ç: –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤
                    print(f"    Dialogue ({len(dialogue)} —Å–æ–æ–±—â–µ–Ω–∏–π):")
                    for msg in dialogue:
                        role = msg.get('role', 'N/A')
                        text = msg.get('text', 'N/A')
                        preview = text.replace('\n', '\\n')[:50]
                        print(f"      [{role}]: {preview}{'...' if len(text) > 50 else ''}")
            print()
        return data
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏: {e}")
        return None

def read_xml_simple(file_path):
    """–ü—Ä–æ—Å—Ç–æ–µ —á—Ç–µ–Ω–∏–µ XML —Ñ–∞–π–ª–∞"""
    try:
        tree = ET.parse(file_path)
        root = tree.getroot()
        
        print("üìñ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ XML:")
        for i, item in enumerate(root.findall('.//item')):
            print(f"  –û–±—ä–µ–∫—Ç {i+1}:")
            print(f"    ID: {item.findtext('id', 'N/A')}")
            print(f"    Topic: {item.findtext('topic', 'N/A')}")
            
            dialogue = item.find('dialogue')
            if dialogue is not None:
                messages = dialogue.findall('message')
                if messages:
                    print(f"    Dialogue ({len(messages)} —Å–æ–æ–±—â–µ–Ω–∏–π):")
                    for msg in messages:
                        role = msg.findtext('role', 'N/A')
                        text = msg.findtext('text', 'N/A')
                        preview = text.replace('\n', '\\n')[:50]
                        print(f"      [{role}]: {preview}{'...' if len(text) > 50 else ''}")
            print()
        return tree
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏: {e}")
        return None

def simple_file_check(file_path):
    """–ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞ –ª—é–±–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞"""
    path = Path(file_path)
    
    if not path.exists():
        print(f"‚ùå –§–∞–π–ª {file_path} –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    print(f"üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞: {path.name}")
    print("-" * 40)
    
    # –ü—Ä–æ–±—É–µ–º JSON
    if check_json_simple(path):
        read_json_simple(path)
        return
    
    # –ü—Ä–æ–±—É–µ–º XML
    if check_xml_simple(path):
        read_xml_simple(path)
        return
    
    print("‚ùå –§–∞–π–ª –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º JSON –∏–ª–∏ XML")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
if __name__ == "__main__":
    # –ü—Ä–æ—Å—Ç–æ —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ –≤–∞—à–µ–º—É —Ñ–∞–π–ª—É
    file_path = "–≤–∞—à_—Ñ–∞–π–ª.json"  # –∏–ª–∏ .xml
    
    simple_file_check(file_path)

