import json
import re

def fix_backslashes_in_text(obj):
    """
    Рекурсивно обрабатывает все строки в объекте JSON, заменяя обратные слеши 
    на прямые, кроме последовательности \n.
    """
    if isinstance(obj, dict):
        for key, value in obj.items():
            if isinstance(value, str):
                # Заменяем все одиночные обратные слеши, кроме \n
                obj[key] = re.sub(r'\\(?!n)', '/', value)
            else:
                fix_backslashes_in_text(value)
    elif isinstance(obj, list):
        for item in obj:
            fix_backslashes_in_text(item)

def process_json_file(input_file, output_file):
    """Читает, обрабатывает и сохраняет JSON-файл"""
    try:
        with open(input_file, 'r', encoding='utf-8') as f:
            data = json.load(f)
        
        fix_backslashes_in_text(data)
        
        with open(output_file, 'w', encoding='utf-8') as f:
            json.dump(data, f, ensure_ascii=False, indent=2)
        
        print(f"Файл успешно обработан. Результат сохранен в {output_file}")
    
    except Exception as e:
        print(f"Ошибка при обработке файла: {e}")

# Использование
if __name__ == "__main__":
    input_filename = "input.json"  # Замените на ваш файл
    output_filename = "output.json"  # Выходной файл
    
    process_json_file(input_filename, output_filename)
